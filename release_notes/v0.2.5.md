# PyWiki v0.2.5 Release Notes

**Released:** 2026-03-01

## Highlights

### Customisable Home Page
The home page (`/`) now renders the `Main/Main Page` wiki page as its content. Edit it like any other page to create a custom landing page for your wiki. When no main page exists, a prompt with a "Create main page" button is shown instead. All the status information (recent changes, namespaces, statistics) has moved to a dedicated `/special/status` page.

### Image Size Control
Both Wikitext and Markdown now support explicit width/height on embedded images ‚Äî matching the workflow familiar from MediaWiki.

### Bug Fixes
The attachment upload panel now works correctly in the browser (cookie auth was being rejected), and the Create Page form correctly defaults to `Main` instead of the first alphabetical namespace.

---

## What's New

### Added

#### Customisable home page
- `/` renders `Main/main-page` content if it exists; otherwise shows a welcome prompt with "Create main page" button
- ‚úèÔ∏è Edit button shown on home page for logged-in users
- Recent changes and namespace list moved to `/special/status`

#### `/special/status` page
- Statistics table: total pages, revisions, users, namespaces, app version, renderer version
- Namespace list with format badges and descriptions
- Recent changes table (last 20 entries)
- Linked from sidebar navigation ("Site status")

#### Rename button on page view
- üöö Rename button added to the page-actions bar (alongside Edit and History) on every page view
- Only visible to logged-in users; links to existing `/wiki/{ns}/{slug}/move` form

#### Image size modifiers ‚Äî Wikitext
| Syntax | Effect |
|--------|--------|
| `[[File:photo.png\|200px]]` | width=200 |
| `[[File:photo.png\|x150px]]` | height=150 |
| `[[File:photo.png\|300x200px]]` | width=300, height=200 |
| `[[File:photo.png\|thumb\|200px\|Caption]]` | thumb + width=200 |

#### Image size suffix ‚Äî Markdown
| Syntax | Effect |
|--------|--------|
| `![alt](attachment:photo.png\|200)` | width=200 |
| `![alt](attachment:photo.png\|x150)` | height=150 |
| `![alt](attachment:photo.png\|300x200)` | width=300, height=200 |

When size is specified, emits `<img width="..." height="...">` directly rather than Markdown `![]()` syntax.

#### Live preview resolves attachment images
- `/api/v1/render` now accepts an optional `slug` query param
- When `slug` is provided, loads that page's attachments from DB and passes them to `render()`
- Editor sends `slug` with every preview request ‚Äî `attachment:` URLs and `[[File:]]` tags now resolve correctly in the live preview pane

### Fixed

- **Attachment upload "Not authenticated"** ‚Äî upload route now uses `get_current_user_id_bearer_or_cookie` which accepts either a Bearer token (API clients) or the browser's `httponly` session cookie; previously only Bearer was accepted, causing all browser-based uploads to fail
- **Create page defaults to wrong namespace** ‚Äî namespace selector now defaults to `Main` (from `settings.default_namespace`) when no `?namespace=` param is present; previously defaulted to first alphabetical namespace (e.g. `Go`)

### Changed
- `get_current_user_id_bearer_or_cookie` dependency added to `app/core/security.py`
- `app/routes/attachments.py` uses the new dual-auth dependency (alias import ‚Äî no route signature changes)
- `app/routes/render.py` gains `slug` and `db` params
- Home view no longer loads `recent` or `namespaces` (moved to status view)

### Tests
- 9 new tests for Wikitext and Markdown size modifiers
- **220 tests total** (was 211 at v0.2.4)

---

## Upgrading from v0.2.4

No database migration or new dependencies required. Deploy and reload.

**To set up a custom home page:** create a page at `Main / Main Page` (slug will be `main-page`) ‚Äî its content becomes the home page.
